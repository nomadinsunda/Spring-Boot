`@Conditional`ì€ Spring Frameworkì—ì„œ **ì¡°ê±´ì— ë”°ë¼ Beanì„ ë“±ë¡í•˜ê±°ë‚˜ ì œì™¸**í•  ìˆ˜ ìˆë„ë¡ í•´ì£¼ëŠ” ê°•ë ¥í•œ ë©”íƒ€ ì• ë…¸í…Œì´ì…˜ì…ë‹ˆë‹¤. ë‹¨ìˆœí•œ ê°œë°œ/ìš´ì˜ í™˜ê²½ ë¶„ê¸°ë¥¼ ë„˜ì–´ì„œ, ë‹¤ì–‘í•œ ì¡°ê±´ ê¸°ë°˜ì˜ êµ¬ì„±(conditional configuration)ì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤. 
---

# ğŸ” `@Conditional` ì™„ì „ ì •ë³µ: Springì˜ ì¡°ê±´ë¶€ êµ¬ì„± ë©”ì»¤ë‹ˆì¦˜

## âœ… ê°œë… ìš”ì•½

`@Conditional`ì€ Springì´ Beanì„ ë“±ë¡í•˜ê±°ë‚˜ êµ¬ì„± í´ë˜ìŠ¤ë¥¼ ì²˜ë¦¬í•  ë•Œ, **íŠ¹ì • ì¡°ê±´ì´ ë§Œì¡±ë˜ëŠ” ê²½ìš°ì—ë§Œ í™œì„±í™”ë˜ë„ë¡ ì œì–´**í•  ìˆ˜ ìˆëŠ” ì• ë…¸í…Œì´ì…˜ì…ë‹ˆë‹¤.

```java
@Conditional(MyCondition.class)
@Configuration
public class MyConditionalConfig {
    @Bean
    public MyService myService() {
        return new MyService();
    }
}
```

> ìœ„ ì½”ë“œì—ì„œ `MyCondition`ì´ trueë¥¼ ë°˜í™˜í•˜ë©´ `MyService`ê°€ ë“±ë¡ë¨

---

## ğŸ§  ì‘ë™ ì›ë¦¬

1. `@Conditional`ì€ í•˜ë‚˜ ì´ìƒì˜ `Condition` ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„ì²´ë¥¼ ì°¸ì¡°í•©ë‹ˆë‹¤.
2. Springì´ êµ¬ì„± í´ë˜ìŠ¤ë¥¼ ì²˜ë¦¬í•˜ëŠ” ê³¼ì •ì—ì„œ `matches()` ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ì—¬ ì¡°ê±´ì„ í‰ê°€í•©ë‹ˆë‹¤.
3. ë°˜í™˜ê°’ì´ `true`ì´ë©´ Bean ë“±ë¡, `false`ì´ë©´ ë“±ë¡í•˜ì§€ ì•ŠìŒ.

### ğŸ”§ `Condition` ì¸í„°í˜ì´ìŠ¤

```java
public interface Condition {
    boolean matches(ConditionContext context, AnnotatedTypeMetadata metadata);
}
```

* `ConditionContext` : í™˜ê²½ ì •ë³´, `BeanFactory`, í´ë˜ìŠ¤ ë¡œë” ë“±ì„ í¬í•¨
* `AnnotatedTypeMetadata` : ì• ë…¸í…Œì´ì…˜ ë©”íƒ€ì •ë³´ì— ì ‘ê·¼ ê°€ëŠ¥

---

## ğŸ› ï¸ ì‚¬ìš© ì˜ˆì‹œ

### 1ï¸âƒ£ ë‹¨ìˆœ í”„ë¡œí¼í‹° ê¸°ë°˜ ì¡°ê±´

```java
public class OnFeatureEnabledCondition implements Condition {
    public boolean matches(ConditionContext context, AnnotatedTypeMetadata metadata) {
        String value = context.getEnvironment().getProperty("feature.enabled");
        return "true".equalsIgnoreCase(value);
    }
}
```

```java
@Conditional(OnFeatureEnabledCondition.class)
@Bean
public FeatureService featureService() {
    return new FeatureService();
}
```

â¡ `feature.enabled=true`ì¼ ë•Œë§Œ Bean ë“±ë¡ë¨

---

### 2ï¸âƒ£ í´ë˜ìŠ¤ ì¡´ì¬ ì—¬ë¶€ ê¸°ë°˜

```java
public class OnClassPresentCondition implements Condition {
    public boolean matches(ConditionContext context, AnnotatedTypeMetadata metadata) {
        try {
            context.getClassLoader().loadClass("com.example.MyClass");
            return true;
        } catch (ClassNotFoundException e) {
            return false;
        }
    }
}
```

â¡ ì§€ì •í•œ í´ë˜ìŠ¤ê°€ `classpath`ì— ìˆì„ ê²½ìš°ì—ë§Œ Bean í™œì„±í™”

---

## ğŸ“¦ Spring Bootì—ì„œì˜ í™œìš©

Spring BootëŠ” `@Conditional`ì„ ê¸°ë°˜ìœ¼ë¡œ ë‹¤ì–‘í•œ ìë™ êµ¬ì„± ì¡°ê±´ ì• ë…¸í…Œì´ì…˜ì„ ì œê³µí•©ë‹ˆë‹¤.

| ì• ë…¸í…Œì´ì…˜                          | ì¡°ê±´                         |
| ------------------------------ | -------------------------- |
| `@ConditionalOnClass`          | ì§€ì •í•œ í´ë˜ìŠ¤ê°€ classpathì— ì¡´ì¬í•  ê²½ìš° |
| `@ConditionalOnMissingBean`    | íŠ¹ì • íƒ€ì…ì˜ Beanì´ ì—†ëŠ” ê²½ìš°         |
| `@ConditionalOnProperty`       | ì§€ì •í•œ í”„ë¡œí¼í‹°ê°€ ì¡´ì¬í•˜ê±°ë‚˜ íŠ¹ì • ê°’ì¼ ê²½ìš°   |
| `@ConditionalOnWebApplication` | ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ í™˜ê²½ì¼ ê²½ìš°            |
| `@ConditionalOnBean`           | ì§€ì •í•œ íƒ€ì…ì˜ Beanì´ ì´ë¯¸ ë“±ë¡ëœ ê²½ìš°    |
| `@ConditionalOnExpression`     | SpEL ì¡°ê±´ì‹ì´ trueì¸ ê²½ìš°         |

ì˜ˆì‹œ:

```java
@Configuration
@ConditionalOnClass(DataSource.class)
public class DataSourceAutoConfiguration {
    ...
}
```

â¡ `DataSource` í´ë˜ìŠ¤ê°€ classpathì— ì¡´ì¬í•˜ë©´ ì´ êµ¬ì„± í´ë˜ìŠ¤ê°€ í™œì„±í™”ë¨

---

## ğŸ” ë™ì‘ ì‹œì 

* `@Conditional`ì€ Springì˜ **Configuration Phase** (ì¦‰, `ConfigurationClassPostProcessor` ì‹¤í–‰ ì‹œì )ì— í‰ê°€ë©ë‹ˆë‹¤.
* ë¹ˆì˜ ì •ì˜(BeanDefinition)ë¥¼ ìƒì„±í• ì§€ ë§ì§€ ê²°ì •í•  ë•Œ ì‚¬ìš©ë©ë‹ˆë‹¤.

---

## ğŸš« ì£¼ì˜í•  ì 

* `@Conditional`ì€ OR ì¡°ê±´ì„ ì§€ì›í•˜ì§€ ì•ŠìŒ (ì§ì ‘ êµ¬í˜„í•´ì•¼ í•¨)
* ëª¨ë“  ì¡°ê±´ì€ `matches()` ë‚´ë¶€ì—ì„œ ì½”ë“œë¡œ êµ¬í˜„í•´ì•¼ í•˜ë¯€ë¡œ ìœ ì§€ë³´ìˆ˜ê°€ ì–´ë ¤ìš¸ ìˆ˜ ìˆìŒ
* `@Profile`ê³¼ëŠ” ë‹¬ë¦¬ Spring í™˜ê²½ í”„ë¡œíŒŒì¼ ê°œë…ê³¼ëŠ” ë³„ê°œ

---

## âœ… `@Conditional` vs `@Profile`

| í•­ëª©    | `@Profile` | `@Conditional`              |
| ----- | ---------- | --------------------------- |
| ëª©ì     | í™˜ê²½ í”„ë¡œíŒŒì¼ ë¶„ê¸° | ëª¨ë“  ì¡°ê±´ ê¸°ë°˜ ë¶„ê¸°                 |
| ì œì•½    | ë‹¨ìˆœ ë¬¸ìì—´ ë¹„êµ  | í´ë˜ìŠ¤ ì¡´ì¬, ì†ì„± ê°’, Bean ì¡´ì¬ ë“±     |
| í™•ì¥ì„±   | ë‚®ìŒ         | ë§¤ìš° ë†’ìŒ (ì»¤ìŠ¤í…€ êµ¬í˜„ ê°€ëŠ¥)           |
| ë‚´ë¶€ ì‚¬ìš© | ë“œë¬¼ê²Œ ì‚¬ìš©     | Spring Boot í•µì‹¬ êµ¬ì„±ì— ê´‘ë²”ìœ„í•˜ê²Œ ì‚¬ìš© |

---

## âœ… ìš”ì•½

* `@Conditional`ì€ ì¡°ê±´ ê¸°ë°˜ìœ¼ë¡œ êµ¬ì„± í´ë˜ìŠ¤ë¥¼ í™œì„±í™”í•˜ê±°ë‚˜ Bean ë“±ë¡ ì—¬ë¶€ë¥¼ ê²°ì •í•˜ëŠ” ê³ ê¸‰ ë©”ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤.
* Spring Bootì˜ ìë™ êµ¬ì„± í•µì‹¬ì€ `@Conditional` ì‹œìŠ¤í…œì— ì˜í•´ êµ¬í˜„ë©ë‹ˆë‹¤.
* ë‹¤ì–‘í•œ ì¡°ê±´ ì• ë…¸í…Œì´ì…˜(`@ConditionalOnXxx`)ë“¤ì€ ëª¨ë‘ ì´ ê¸°ë°˜ ìœ„ì— ì¡´ì¬í•©ë‹ˆë‹¤.
* `@Profile`ë³´ë‹¤ í›¨ì”¬ ê°•ë ¥í•˜ê³  ìœ ì—°í•œ ì¡°ê±´ ì œì–´ê°€ ê°€ëŠ¥í•˜ì§€ë§Œ, ë³µì¡ì„±ë„ ë™ë°˜í•©ë‹ˆë‹¤.
