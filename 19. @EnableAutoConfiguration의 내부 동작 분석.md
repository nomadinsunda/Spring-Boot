## âœ¨ @EnableAutoConfigurationì˜ ë‚´ë¶€ ë™ì‘ ì™„ì „ í•´ë¶€

### ğŸ”§ 1. ì„ ì–¸ êµ¬ì¡°

```java
@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Inherited
@AutoConfigurationPackage
@Import(AutoConfigurationImportSelector.class)
public @interface EnableAutoConfiguration {
}
```

* í•µì‹¬ì€ `@Import(AutoConfigurationImportSelector.class)`
* ì¦‰, ì´ ì• ë„ˆí…Œì´ì…˜ì„ ì‚¬ìš©í•˜ë©´ `AutoConfigurationImportSelector`ê°€ **ì‹¤í–‰ ì‹œì ì— Beanì„ ìë™ìœ¼ë¡œ ë“±ë¡**í•˜ëŠ” ì—­í• ì„ ìˆ˜í–‰

---

### ğŸ§  2. AutoConfigurationImportSelectorë€?

```java
public class AutoConfigurationImportSelector
    implements DeferredImportSelector, BeanClassLoaderAware, ResourceLoaderAware,
               BeanFactoryAware, EnvironmentAware, Ordered {

    @Override
    public String[] selectImports(AnnotationMetadata annotationMetadata) {
        AutoConfigurationEntry autoConfigurationEntry = getAutoConfigurationEntry(annotationMetadata);
        return StringUtils.toStringArray(autoConfigurationEntry.getConfigurations());
    }
}
```

* `DeferredImportSelector`ë¥¼ êµ¬í˜„í•œ í´ë˜ìŠ¤ë¡œì„œ, ì¼ë°˜ì ì¸ `ImportSelector`ë³´ë‹¤ **ConfigurationClassPostProcessor ì´í›„ì—** í˜¸ì¶œë©ë‹ˆë‹¤.
* ì¦‰, ì¼ë°˜ì ì¸ `@Configuration` ë“±ë¡ ì´í›„ **ì¶”ê°€ì ìœ¼ë¡œ ìë™ êµ¬ì„± í›„ë³´ë“¤ì„ ì„ íƒ**í•˜ê²Œ ë©ë‹ˆë‹¤.

---

### ğŸ” 3. getAutoConfigurationEntry()ì˜ íë¦„

```java
protected AutoConfigurationEntry getAutoConfigurationEntry(AnnotationMetadata metadata) {
    if (!isEnabled(metadata)) {
        return EMPTY_ENTRY;
    }

    AnnotationAttributes attributes = getAttributes(metadata);
    List<String> configurations = getCandidateConfigurations(metadata, attributes); // â˜…

    configurations = removeDuplicates(configurations);

    Set<String> exclusions = getExclusions(metadata, attributes);
    checkExcludedClasses(configurations, exclusions);

    configurations.removeAll(exclusions);
    configurations = getConfigurationClassFilter().filter(configurations); // â˜… ì¡°ê±´ í•„í„°
    fireAutoConfigurationImportEvents(configurations, exclusions);

    return new AutoConfigurationEntry(configurations, exclusions);
}
```

#### ğŸŸ¡ í•µì‹¬ í•¨ìˆ˜

* **getCandidateConfigurations**: ìë™ êµ¬ì„± í›„ë³´ ëª©ë¡ì„ ë¡œë”© (ê¸°ë³¸ì€ `SpringFactoriesLoader`)
* **getConfigurationClassFilter().filter**: `@ConditionalOnClass`, `@ConditionalOnMissingBean` ë“±ì˜ ì¡°ê±´ìœ¼ë¡œ í•„í„°ë§

---

### ğŸ—‚ï¸ 4. ìë™ êµ¬ì„± í›„ë³´ ë¡œë”© ë°©ì‹

#### Spring Boot 2.x

```java
// spring.factories
org.springframework.boot.autoconfigure.EnableAutoConfiguration=\
com.example.A, \
com.example.B, \
com.example.C
```

* `SpringFactoriesLoader.loadFactoryNames(...)` í˜¸ì¶œ
* classpath ìƒì˜ ëª¨ë“  `META-INF/spring.factories` ë¥¼ ê²€ìƒ‰

#### Spring Boot 3.x

```properties
# AutoConfiguration.imports (new metadata format)
com.example.A
com.example.B
com.example.C
```

* `META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.imports` íŒŒì¼ì„ ê¸°ë°˜ìœ¼ë¡œ ë¡œë”©
* ë” ë¹ ë¥´ê³  ëª¨ë“ˆí™”ëœ íŒŒì‹± êµ¬ì¡°

---

### âœ… 5. ì¡°ê±´ë¶€ ë¡œë”© ë©”ì»¤ë‹ˆì¦˜

AutoConfiguration í´ë˜ìŠ¤ì—ëŠ” ë‹¤ìŒê³¼ ê°™ì€ **ì¡°ê±´ë¶€ ì• ë„ˆí…Œì´ì…˜**ì´ ë¶™ì–´ì•¼ë§Œ ì‹¤ì œ ë“±ë¡ë©ë‹ˆë‹¤.

#### ì˜ˆì‹œ: `DataSourceAutoConfiguration`

```java
@Configuration
@ConditionalOnClass(name = "javax.sql.DataSource")
@ConditionalOnMissingBean(DataSource.class)
public class DataSourceAutoConfiguration {
    // DataSource ê´€ë ¨ Bean ë“±ë¡
}
```

#### ì¡°ê±´ ì• ë„ˆí…Œì´ì…˜ ì¢…ë¥˜

| ì• ë„ˆí…Œì´ì…˜                          | ì„¤ëª…                                  |
| ------------------------------ | ----------------------------------- |
| `@ConditionalOnClass`          | í´ë˜ìŠ¤ê°€ ì¡´ì¬í•  ê²½ìš°ì—ë§Œ                       |
| `@ConditionalOnMissingBean`    | íŠ¹ì • Beanì´ ì—†ì„ ë•Œë§Œ                      |
| `@ConditionalOnProperty`       | application.propertiesì— ì„¤ì •ëœ í”„ë¡œí¼í‹° ê¸°ì¤€ |
| `@ConditionalOnWebApplication` | ì›¹ í™˜ê²½ì¼ ë•Œë§Œ                            |

> ì¦‰, ìë™ êµ¬ì„±ì€ **í•„ìš”í•œ í™˜ê²½ì´ ê°–ì¶°ì¡Œì„ ë•Œë§Œ ì ìš©**ë˜ë©°, ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ë¬´ì‹œë¨.

---

### ğŸ—ï¸ 6. ì „ì²´ êµ¬ì„± íë¦„ ìš”ì•½

```text
@SpringBootApplication
    â””â”€ @EnableAutoConfiguration
         â””â”€ @Import(AutoConfigurationImportSelector.class)
              â””â”€ getAutoConfigurationEntry()
                    â””â”€ getCandidateConfigurations()
                          â””â”€ META-INF/spring.factories or AutoConfiguration.imports
                    â””â”€ ì¡°ê±´ ì• ë„ˆí…Œì´ì…˜(@Conditional...) ê²€ì‚¬
                    â””â”€ ë‚¨ì€ Configuration í´ë˜ìŠ¤ë“¤ì„ BeanDefinitionìœ¼ë¡œ ë“±ë¡
```

---

### ğŸ§¾ 7. ì»¤ìŠ¤í„°ë§ˆì´ì§• í¬ì¸íŠ¸

* `spring.autoconfigure.exclude`:

  ```yaml
  spring:
    autoconfigure:
      exclude:
        - com.example.MyAutoConfiguration
  ```

* `@AutoConfigurationPackage`:

  ```java
  @AutoConfigurationPackage
  public class MyAutoConfigurationPackageMarker {}
  ```

  ì´ ì• ë„ˆí…Œì´ì…˜ì€ ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ì˜ base packageë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.

---

### ğŸ§  ì •ë¦¬

| êµ¬ì„± ìš”ì†Œ                                                 | ì—­í•                         |
| ----------------------------------------------------- | ------------------------- |
| `@EnableAutoConfiguration`                            | ìë™ êµ¬ì„±ì˜ ì§„ì…ì                 |
| `AutoConfigurationImportSelector`                     | ìë™ êµ¬ì„± í›„ë³´ë¥¼ ì„ íƒí•˜ê³  ì¡°ê±´ì— ë”°ë¼ í•„í„°ë§ |
| `SpringFactoriesLoader` / `AutoConfiguration.imports` | êµ¬ì„± í›„ë³´ ëª©ë¡ì„ ë¡œë”©              |
| `@Conditional...`                                     | ì‹¤ì œ ë“±ë¡ ì—¬ë¶€ íŒë‹¨ ê¸°ì¤€            |
| `DeferredImportSelector`                              | ê¸°ì¡´ Config ì²˜ë¦¬ ì´í›„ ë¡œë”©        |
